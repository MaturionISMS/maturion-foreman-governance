# WARNING_REMEDIATION_REPORT Schema

## Status
**Type**: Canonical Schema Definition  
**Authority**: Binding on ALL agents  
**Version**: 1.0.0  
**Date**: 2026-01-07  
**Integration**: WARNING_DISCOVERY_BLOCKER_PROTOCOL.md, QA_POLICY_MASTER.md Section 3.3

---

## Purpose

Defines the required structure and content for Warning Remediation Reports generated by the original responsible agent after fixing warnings from prior work.

---

## Required Fields

### 1. Remediation Metadata

```json
{
  "remediationMetadata": {
    "remediatingAgentId": "string (required) - ID of agent performing remediation (original responsible agent)",
    "remediationTimestamp": "ISO 8601 datetime (required) - When remediation completed",
    "originalWorkReference": "string (required) - Original job/wave/subwave that introduced warnings",
    "warningDiscoveryReportReference": "string (required) - Path to original WARNING_DISCOVERY_REPORT",
    "discoveringAgentId": "string (required) - Agent that discovered warnings",
    "repository": "string (required) - Repository where remediation performed"
  }
}
```

---

### 2. Warnings Addressed

```json
{
  "warningsAddressed": {
    "warnings": [
      {
        "sourceFile": "string (required) - File that had warning",
        "lineNumber": "number (optional) - Line number if applicable",
        "warningMessage": "string (required) - Original warning message",
        "remediationAction": "string (required) - Detailed description of fix applied",
        "remediationCommit": "string (required) - Git commit SHA for fix",
        "remediationApproach": "enum (required) - FIX_ROOT_CAUSE | REFACTOR | ARCHITECTURE_UPDATE | WHITELIST_JUSTIFIED"
      }
    ],
    "totalWarningsRemediated": "number (required) - Count of warnings fixed"
  }
}
```

**Remediation Approach**:
- `FIX_ROOT_CAUSE`: Fixed underlying code issue causing warning
- `REFACTOR`: Refactored code to eliminate warning
- `ARCHITECTURE_UPDATE`: Updated architecture and code to resolve warning
- `WHITELIST_JUSTIFIED`: Added to whitelist with FM/Governance approval (only for MEDIUM/LOW warnings)

---

### 3. Evidence of Remediation

```json
{
  "remediationEvidence": {
    "beforeCiLogReference": "string (optional) - CI log showing warnings before fix",
    "afterCiLogReference": "string (required) - CI log showing zero warnings after fix",
    "ciRunUrl": "string (optional) - URL to successful CI run",
    "ciRunTimestamp": "ISO 8601 datetime (required) - When clean CI run completed",
    "localBuildConfirmation": "string (optional) - Local build output showing zero warnings",
    "gitCommits": [
      {
        "commitSha": "string (required) - Commit SHA",
        "commitMessage": "string (required) - Commit message",
        "commitTimestamp": "ISO 8601 datetime (required)"
      }
    ]
  }
}
```

---

### 4. Root Cause Analysis

```json
{
  "rootCauseAnalysis": {
    "whyWarningsMissed": "string (required) - Explanation of why warnings were not caught during original work",
    "qaGapIdentified": "boolean (required) - Was there a QA gap?",
    "qaGapDescription": "string (conditional) - If qaGapIdentified=true, describe gap",
    "processGapIdentified": "boolean (required) - Was there a process gap?",
    "processGapDescription": "string (conditional) - If processGapIdentified=true, describe gap",
    "toolingGapIdentified": "boolean (required) - Was there a tooling gap?",
    "toolingGapDescription": "string (conditional) - If toolingGapIdentified=true, describe gap"
  }
}
```

---

### 5. Process Improvement Proposal

```json
{
  "processImprovementProposal": {
    "preventionMeasures": [
      {
        "measure": "string (required) - Specific prevention measure",
        "category": "enum (required) - QA_ENHANCEMENT | PROCESS_CHANGE | TOOLING_UPDATE | EDUCATION",
        "implementationPlan": "string (required) - How to implement",
        "owner": "string (optional) - Who will implement"
      }
    ],
    "qaEnhancementRequired": "boolean (required) - Should QA be enhanced?",
    "qaEnhancementDescription": "string (conditional) - If qaEnhancementRequired=true, describe enhancement"
  }
}
```

**Prevention Measure Categories**:
- `QA_ENHANCEMENT`: Add new tests or checks to QA suite
- `PROCESS_CHANGE`: Update build/handover process
- `TOOLING_UPDATE`: Update linter config, CI checks, etc.
- `EDUCATION`: Agent training or documentation update

---

### 6. Verification Request

```json
{
  "verificationRequest": {
    "requestTimestamp": "ISO 8601 datetime (required) - When verification requested",
    "verificationRecipient": "string (required) - Discovering agent ID",
    "verificationInstructions": "string (required) - Instructions for discovering agent to verify",
    "readyForVerification": "boolean (required) - Is remediation ready for verification?"
  }
}
```

---

## Complete Schema Example

```json
{
  "schemaVersion": "1.0.0",
  "reportType": "WARNING_REMEDIATION_REPORT",
  "remediationMetadata": {
    "remediatingAgentId": "api-builder-01",
    "remediationTimestamp": "2026-01-07T16:00:00Z",
    "originalWorkReference": "issue-401 / subwave 2.3",
    "warningDiscoveryReportReference": "/governance/evidence/warnings/discovery/WARNING_DISCOVERY_REPORT_2026-01-07T14-35-00Z_ui-builder-01.json",
    "discoveringAgentId": "ui-builder-01",
    "repository": "maturion-foreman-office-app"
  },
  "warningsAddressed": {
    "warnings": [
      {
        "sourceFile": "src/components/ParkingStation.tsx",
        "lineNumber": 42,
        "warningMessage": "React Hook useEffect has a missing dependency: 'fetchData'",
        "remediationAction": "Added fetchData to useEffect dependency array and wrapped fetchData in useCallback to prevent infinite re-renders",
        "remediationCommit": "xyz789abc012",
        "remediationApproach": "FIX_ROOT_CAUSE"
      },
      {
        "sourceFile": "src/utils/api.ts",
        "lineNumber": 15,
        "warningMessage": "Argument of type 'string | undefined' is not assignable to parameter of type 'string'",
        "remediationAction": "Added type guard to ensure parameter is string before passing to function. Updated architecture to document required vs optional parameters.",
        "remediationCommit": "xyz789abc013",
        "remediationApproach": "FIX_ROOT_CAUSE"
      }
    ],
    "totalWarningsRemediated": 2
  },
  "remediationEvidence": {
    "beforeCiLogReference": "https://github.com/org/repo/actions/runs/12345 (failed with warnings)",
    "afterCiLogReference": "https://github.com/org/repo/actions/runs/12350 (passed with zero warnings)",
    "ciRunUrl": "https://github.com/org/repo/actions/runs/12350",
    "ciRunTimestamp": "2026-01-07T15:55:00Z",
    "localBuildConfirmation": "npm run build && npm run lint -- all checks passed with 0 warnings",
    "gitCommits": [
      {
        "commitSha": "xyz789abc012",
        "commitMessage": "fix: Add fetchData to useEffect dependencies with useCallback wrapper",
        "commitTimestamp": "2026-01-07T15:45:00Z"
      },
      {
        "commitSha": "xyz789abc013",
        "commitMessage": "fix: Add type guard for optional parameters in api.ts",
        "commitTimestamp": "2026-01-07T15:50:00Z"
      }
    ]
  },
  "rootCauseAnalysis": {
    "whyWarningsMissed": "During subwave 2.3 execution, linter was not run locally before handover. CI warnings were visible but were not classified as blockers. Handover report claimed 'zero warnings' based on incomplete local validation.",
    "qaGapIdentified": true,
    "qaGapDescription": "QA suite did not include linter check as mandatory pre-handover step. Builder handover checklist did not require running 'npm run lint' before declaring READY_FOR_MERGE.",
    "processGapIdentified": true,
    "processGapDescription": "Handover process allowed builder to declare 'zero warnings' without CI validation evidence. Gate did not enforce warning check at merge time.",
    "toolingGapIdentified": false,
    "toolingGapDescription": null
  },
  "processImprovementProposal": {
    "preventionMeasures": [
      {
        "measure": "Add mandatory 'npm run lint' to builder handover checklist",
        "category": "PROCESS_CHANGE",
        "implementationPlan": "Update BUILDER_QA_HANDOVER_POLICY.md to require explicit linter execution evidence before handover",
        "owner": "governance-admin"
      },
      {
        "measure": "Add linter check to CI as blocking gate",
        "category": "TOOLING_UPDATE",
        "implementationPlan": "Update .github/workflows/ci.yml to include linter step that fails on any warnings",
        "owner": "fm"
      },
      {
        "measure": "Add warning count to BUILD_QA_REPORT.json schema",
        "category": "QA_ENHANCEMENT",
        "implementationPlan": "Update BUILD_QA_REPORT schema to include warningCount field; gate validates warningCount=0",
        "owner": "governance-admin"
      }
    ],
    "qaEnhancementRequired": true,
    "qaEnhancementDescription": "Add automated linter check to QA suite that fails if any warnings present. Include warning count in QA report schema for gate validation."
  },
  "verificationRequest": {
    "requestTimestamp": "2026-01-07T16:00:00Z",
    "verificationRecipient": "ui-builder-01",
    "verificationInstructions": "Please pull latest code, run 'npm run build && npm run lint', verify zero warnings in both commands, then generate WARNING_VERIFICATION_REPORT.",
    "readyForVerification": true
  }
}
```

---

## Validation Rules

### Required Field Validation
- All fields marked `(required)` MUST be present and non-empty
- All fields marked `(conditional)` MUST be present if condition is true
- All timestamps MUST be valid ISO 8601 format
- All enums MUST use specified values

### Warnings Addressed Validation
- `totalWarningsRemediated` MUST equal length of `warnings` array
- Each warning MUST have `remediationCommit` referencing actual git commit
- `remediationApproach` MUST be one of: FIX_ROOT_CAUSE, REFACTOR, ARCHITECTURE_UPDATE, WHITELIST_JUSTIFIED
- `WHITELIST_JUSTIFIED` ONLY allowed for MEDIUM/LOW severity warnings

### Evidence Validation
- `afterCiLogReference` MUST show zero warnings
- `gitCommits` array MUST NOT be empty
- All commit SHAs MUST be valid and verifiable in repository

### Root Cause Analysis Validation
- `whyWarningsMissed` MUST be at least 100 characters (substantive explanation)
- If any gap identified (qaGapIdentified, processGapIdentified, toolingGapIdentified) = true, corresponding description MUST be provided

### Process Improvement Validation
- `preventionMeasures` array MUST NOT be empty
- Each measure MUST have `implementationPlan`
- At least one prevention measure MUST address identified gap (if any gap identified)

---

## Usage

### When to Generate
- After ALL warnings from WARNING_DISCOVERY_REPORT are fixed
- After CI run confirms zero warnings
- After commits are pushed to repository
- Before requesting verification from discovering agent

### Who Generates
- Original responsible agent (the agent that introduced warnings)
- NOT the discovering agent (they generate WARNING_VERIFICATION_REPORT)

### What Happens Next
1. Original agent generates this report
2. Original agent submits to FM/Governance
3. FM/Governance forwards to discovering agent
4. Discovering agent pulls latest code
5. Discovering agent verifies warnings remediated
6. Discovering agent generates WARNING_VERIFICATION_REPORT
7. If verified, discovering agent may resume work
8. Original agent may resume normal work

---

## Storage Location

**Path**: `/governance/evidence/warnings/remediation/WARNING_REMEDIATION_REPORT_<timestamp>_<remediatingAgentId>.json`

**Example**: `/governance/evidence/warnings/remediation/WARNING_REMEDIATION_REPORT_2026-01-07T16-00-00Z_api-builder-01.json`

**Committed**: YES - Must be committed to repository for audit trail

---

## Integration

This schema is referenced by:
- `WARNING_DISCOVERY_BLOCKER_PROTOCOL.md` Section 3.4
- `QA_POLICY_MASTER.md` Section 3.3.3
- `BUILDER_QA_HANDOVER_POLICY.md` Section 8.4

---

## Template

See: `governance/templates/WARNING_REMEDIATION_REPORT.template.md`

---

**Document Authority**: Governance Administrator  
**Approval**: Johan (Maturion Engineering Leadership)  
**Effective Date**: 2026-01-07
